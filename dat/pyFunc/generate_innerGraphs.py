from sys import argv
import re
import math
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx
import matplotlib.tri as mtri
from mpl_toolkits.mplot3d import Axes3D
from matplotlib.patches import Circle, PathPatch
from matplotlib.text import TextPath
from matplotlib.transforms import Affine2D
import mpl_toolkits.mplot3d.art3d as art3d
from operator import itemgetter 
from scipy.ndimage.filters import gaussian_filter1d

def read_instance(instancefile):
	file_ = open(instancefile, 'r')
	line_ = file_.readline()
	list_ = re.split("\t|\n", line_)
	nb_tars_ = int(list_[0])
	#departure
	line_ = file_.readline()
	list_ = re.split("\t|\n", line_)    
	departure = [float(list_[0])]
	departure.append(float(list_[1]))
	#arrival
	line_ = file_.readline()
	list_ = re.split("\t|\n", line_)    
	arrival = [float(list_[0])]
	arrival.append(float(list_[1]))
	#target circles
	itr = 1
	line_ = file_.readline()
	tar_locs = []
	while itr <= nb_tars_:
		list_ = re.split("\t|\n", line_)
		tar_loc_x = float(list_[0])
		tar_loc_y = float(list_[1])
		tar_rad = float(list_[2])
		tar_locs.append([tar_loc_x, tar_loc_y, tar_rad])

		itr += 1   
		line_ = file_.readline()
	''' rewards shreshold '''
	list_ = re.split("\t|\n", line_)
	tar_rews = [0]
	for e in list_:
		if e != '':
			tar_rews.append(float(e))
	tar_rews.append(0)
	''' print observation point '''
	line_ = file_.readline()
	if True:
		tar_idx = 1
		OBPX = []
		OBPY = []
		OBPREW = []
		while tar_idx <= nb_tars_:
			list_ = re.split("\t|\n", line_)
			obpX = []
			obpY = []
			obpRew = []
			# print(list_)
			for e in list_:
				if e != '':
					list2_ = re.split(":", e)
					r = float(list2_[0])
					angle = float(list2_[1])
					obp_x = r * math.cos(angle) + tar_locs[tar_idx-1][0]
					obp_y = r * math.sin(angle) + tar_locs[tar_idx-1][1]
					obp_rew = float(list2_[2])
					obpX.append(obp_x)
					obpY.append(obp_y)
					obpRew.append(obp_rew)
			tar_idx += 1
			OBPX.append(obpX)
			OBPY.append(obpY)
			OBPREW.append(obpRew)
			line_ = file_.readline()

	file_.close()
	return departure, arrival, tar_locs, tar_rews, OBPX, OBPY,OBPREW




def plot_ObP_graph(center, obpx, obpy, obprew):
	x = np.array(obpx)
	y = np.array(obpy)
	fig = plt.figure()
	ax = fig.add_subplot(111)
	# plt.axis('off')
	ax.set_xlim([(center[0]-center[2]-0.1), (center[0]+center[2]+0.1)])
	ax.set_ylim([(center[1]-center[2]-0.1), (center[1]+center[2]+0.1)])
	ax.set_aspect('equal', adjustable='box')
	''' big circle ''' 
	circle = plt.Circle((center[0], center[1]), radius=center[2], edgecolor='k',fill=False)
	ax.add_artist(circle)
	''' plog points, including boundary points and obser. points, with triangulation '''
	triang = mtri.Triangulation(x, y)
	ax.triplot(triang, c="#D3D3D3", marker='.', markerfacecolor="black", markeredgecolor="black", markersize=5)
	''' plot 16 boundary points '''
	if True:
		for i in range(16):
			circle = plt.Circle((x[i], y[i]), radius=0.02, edgecolor='k',facecolor='k')
			ax.add_artist(circle)

	for i, txt in enumerate(range(1,len(x)+1)):
		ax.annotate(txt-1,  (x[i]+0.02, y[i]-0.02), horizontalalignment='right', verticalalignment='top',size=10)
	plt.show()



def plot_ObP_graph222():
	center = [2,2,1.0]
	x = np.array([128.44981342158053,84.56240865525592,121.2862152951911,94.66147115455237,142.78878230839828,118.55188253847233,93.51096202535497,102.49205427604416,124.39530612049268,79.86696405219413,89.03689056889387,103.02633937347305,126.44940854392584,103.87114334320655,98.27009682473694,136.86414483273154,107.65184938785559,94.44053562661715,63.17041773503485,103.46728535499948,94.56712622613045,97.78508730576658,60.5546156568375,120.22815901438577,94.75172606735637,81.10162351085458,121.86082959845889,97.67816672823906,114.07166078754933,84.59839619758206,89.66303045294227,119.8924371828999,75.72517043035167,123.26774152998676,129.2487288068016,95.6685243862141,69.93515599213498,125.87639547659961,80.12005851130318,93.87998623377553,97.54577284003585,71.56637979580822,148.14435913258532,92.67953636535366,128.82068583404975,54.061741382309435,74.42163524313644,94.57486355048627,119.60047867430133,63.6978931825982,79.93409362800833,120.02396796539792,84.66424457495533,144.7503012661855,78.18110023826598,101.26975400414662,64.82662483570726,132.41385987641576,141.0528543086548,124.38800584229874,62.54583584210523,79.05606682271684,135.37732600006458,69.6344061954732,130.14162692674276,71.5637240844256,86.05192028611047,87.4641554909154,72.52523755908312,79.41433387254551,67.56420760362667,139.85883732368146,127.27002337811857,58.94620805972926,65.31164243651455,101.33714506941574,104.5635314374962,114.07130282323428,83.77619398146412,110.28049609036789,126.31497668921399,109.22880271660875,84.84673782004687,136.99271744115,66.18315331960306,94.17661854277826,96.40491473388171,92.8654539136139,68.88801217904339,135.14369279375745,83.35667636072075,99.02581653973911,91.49251334102084,63.99233905571974,58.9551229925152,77.45461215401357,104.47771392478545,84.04454076468654,60.334251049510115,59.3170647429539,112.00560468203602,77.47979371790599,111.20827487664853,97.74287905761443,83.54588891535673,70.21892628953272,113.38405223267192,139.5472020849575,96.40405675476426,132.31770602893283,78.37394950222951,116.66845670592699,61.87638013573318,121.37580904597507,120.2467713783312,71.03113162029075,74.19264105118533,71.24388761388842,86.63079057519157,126.36645418633528,112.8282726495075,60.75664935888301,112.43629792969972,119.14904250797913,119.50017864122037,129.95438709324785,123.67019282773026,117.35921425873399,78.15132109347279,116.92133668962543,76.44704749669769,111.7793548600043,134.210550050176,86.1716135915301,62.59435590601592,129.41147907692857,99.49114493940199,94.1769420736607,72.79371362432485,76.5390791151624,143.8832982097086,137.0350410999473,125.74053902443518,106.75808970938564,105.56688768178985,84.17275651970829,59.58820236061386,85.29506483922977,129.85822706019064,114.02745504703628,65.9024102921388,62.54415029056757,85.05946493101467,69.69821000908205,126.44542654658015,102.60063039384994,74.20931760237129,126.33486658653052,85.72910097631717,88.5220029379692,80.83828153076028,139.31848533767445,99.64976417694679,91.11272777814791,125.93346976813142,141.77352761895975,96.75147191597945,72.81236271120824,124.85849636048573,105.73260796250237,100.94361281146094,118.90550834919375,131.74444373816115,55.77734783702928,89.45548142384877,64.30279907540309,93.67060209833834,65.26121013507485,141.80059364765316,80.664924051084,111.74044336233342,70.45345777066927,89.73508682074592,95.06454324735691,97.6943473793895,121.7538706427567,147.8473206972182,122.1147100148242,118.65571461159183,136.77587343922943,88.23563815124473,123.4596402785679,71.33490253745272,108.5059476025612,93.75060789724104,116.84172199568997,116.99684847529808,83.26268092868668,103.37680486303023,90.4046373941086,125.76344913146711,91.55644173856815,130.60532315805565,95.7216781969943,119.69178184355805,79.37125763609461,95.64671771432097,117.80793960715359,77.63425871064378,109.17509188738576,131.17354792227874,111.28239997797577,64.63518414863003,89.28919088567238,55.560184761364994,63.22944102149401,139.56076025860872,119.86590474640053,91.43348948417858,61.053775199061164,91.7573178954228,87.44086240461112,101.05123012632727,77.2668187797511,74.90412493114195,111.43158607416801,87.15220033279118,143.54676685074722,105.15285138729563,60.747549703973036,143.04423667410208,133.00438803445363,64.49999141537558,131.80054952180174,68.25991331084083,89.07012940327574,69.48141040873108,70.28267176417748,112.16322515441226,79.8184121632773,69.50524729816475,124.25431196695752,127.33696972817117,90.78048358330841,103.93247733945697,128.98886762699655,96.80126886232307,52.55640476777419,109.96134759978884,93.10382071750392,57.4083209683419,70.09351421470814,138.64986901834888,88.70784065366159,149.49974888221206,103.11449388316889,78.97850304719637,96.4590043485597,58.49149795967077,85.50817328903568,119.58611862003478,131.4001446700872,64.7406674541364,125.02611277752908,103.13207721902333,139.3256268503343,91.08579912633003,63.32244016511609,80.70647693120989,64.72250367548918,105.7956016739927,121.01077653328815,132.50318122661562,147.34661926115865,122.44825406441129,90.18812257342425,82.84658352807172,113.39795913419269,113.46589455281864,117.52641842132591,53.23264796723277,129.74336845047753,83.7301015662907,108.06272946244364,62.22028440970633,64.58070169877392,78.05512516278425,116.8977946975341,87.25000073660726,105.17361123097118,137.4759067222546,112.90038413468095,62.236202959754735,118.5484336746836,105.63120686280767,117.94544395817783,81.73935281295684,106.00186096582654,117.98844307986043,75.25460001246252,71.09959522146771,126.39243581938567,118.15247585696778,124.66006998911948,75.16475712560495,132.71338717223438,106.35970665661807,139.77052092336564,93.73306089521039,148.009619632092,79.09713879723171,124.66185441155251,138.94710069325774,136.98300080711806,61.65056696291684,134.2004843623394,129.52542453580736,108.79505870010613,86.88255454018102,69.61137786563819,74.53859560752404,128.10867686024886,121.60432270594899,97.44878759253531,62.62424275393528,104.62860073935308,141.15904324995697,108.20770485142165,92.76516011790267,104.13229710579563,59.632319875945846,64.83260081675778,108.41397243606978,133.62174847651983,127.2605441751222,73.58055117738105,123.35527172586444,81.14488848798783,106.29906971832972,124.09491262667377,64.3851073872828,119.46922355537161,127.05446993408174,123.19446704078354,70.5119603148072,58.45319810911137,133.65231142931373,106.03811762061393,81.63927887530855,109.07518673528264,56.88962535071339,108.66476695080732,119.73638023234956,73.96096763062891,108.24877338245442,62.71021794055008,132.8980095700703,70.24971453623394,68.44276354282961,114.25338077594134,141.56971139418835,98.60773427193881,64.01203457128086,133.12202506765652,83.67956671327119,94.26573914279986,128.5516291994325,93.74597335933507,128.74346357453717,105.96257688598511,68.91063990759518,143.78881673978407,64.92734638290145,116.25866023080455,108.53999711716178,124.87000101500297,80.27428424124436,105.69686168387963,140.65614221822682,141.9963507352201,77.93208826793673,127.15452630797999,113.6694669907798,77.79603493945991,117.55968318659737,73.16923415438255,59.55148866345269,74.63923979020721,118.91339748151466,117.27917233626775,56.222361487362996,125.94490489848016,84.26252743147424,85.33798000272073,123.97141310370479,82.03456748631646,142.12737053536114,74.62385320073832,136.3628471638025,68.70540790053931,59.303226957069,100.97120382933991,76.1443889644476,90.81825686839613,53.2608979994206,114.83172445171614,94.30176852820716,121.1855677927401,144.68432200870555,84.40754615444503,139.25528424507317,144.62060787618677,121.24214339031415,86.39854599158447,65.61717910261613,100.49463155749474,57.48080005745811,104.33870968855288,72.55375999714369,93.9019971196587,99.4474423318994,91.53809043517674,90.15555717427803,67.47771327842801,114.8471124879285,145.57998258183275,62.766993626741886,72.81693436867597,53.45470568348214,90.24285953612905,112.02200730609853,63.811050859196364,81.08085955128949,83.09761154954064,62.50363491936134,101.10396033882645,105.38130746605816,109.8714856716659,65.06188646503016,138.51471395491598,69.83968955375286,87.82243607960737,79.36174332386678,81.69875388090169,60.28251159932552,142.09523562956824,94.01938248399425,91.92370799793996,91.6161870770148,112.80615782268815,107.63545200102438,67.56909146183429,122.0522236118053,103.04382563255609,139.8835386759736,118.51167937380906,134.06216116085423,99.51410601031712,112.66956158704605,96.05783727837168,130.44328602174414,68.03472547040094,146.00961602137065,57.1058177577192,66.79040122740547,139.59631130544827,60.17154018647939,99.84631003374773,103.03630991424058,129.76389326510932,113.05908142130588,78.43471412562731,86.67331943317984,126.00329970470658,66.46335491224252,68.13603476147341,78.17242323643944,82.97561032372587,63.33508937986348,99.04988835947927,98.33976035502411,79.68014619438767,103.1414808232785,108.19611059261209,86.4657516598464,75.1502802250062,117.72965561851197,67.01348848836292,122.34963901227695,140.81561391728326,90.12979662814881,128.39173485341553,69.26339195073042,59.89473985866326,99.78692895373786,110.63771976787811,117.85433928336795,115.64831695588691,58.53615127479157,116.70905267926896])
	y = np.array([127.04016672058916,126.82504936570822,140.60935284397885,50.93960242959375,121.306339633182,75.72799649228095,85.48440885931218,63.73552474548612,138.5848615299764,138.27823616004736,87.53524041140015,93.4118462376348,106.55677418221062,114.80217042248695,149.11954738191523,74.27963208366972,104.54523937164744,137.23727777216115,132.01596274029822,89.93022183625646,57.243785451034135,60.762464886834145,102.0764522677371,60.53173321656088,148.76841314547698,55.224880055163275,142.84523461561557,133.01846589801144,94.52292389315737,125.33600403207548,93.42660205196725,58.24651579898532,82.80130384696191,88.17535606905096,71.05463140351857,131.60456168035205,113.48360689069297,76.8806973042305,125.39390530040606,116.44834129939012,83.58242499492405,67.34392488243917,96.80888989336798,96.30529944734077,113.67399239633413,84.60263349873821,81.52976025156033,125.42769935531246,66.7467109034571,69.52185962664473,90.73882288958556,55.113886257320985,54.99092196519448,121.50658123890541,87.29180920872669,93.62522747316004,118.51745607668383,81.04362408285579,79.13697881148649,63.85881613676716,88.602277103146,84.42560874173574,72.75908766055814,116.37622401222221,98.12321386166245,116.64574155912926,100.2314568965994,56.46906154877828,119.51480025045565,119.20033463481752,100.96014145800017,128.7575309650237,64.83473553409749,119.96268186704783,81.21116423117756,108.14091782683852,88.25546166003177,120.05613215096167,76.50764766412442,58.813668527824305,108.8082065056471,142.10034679688417,106.77780534580347,121.72438391115467,66.7858331341199,73.63547405312043,88.39405919671572,111.22444885690308,98.46158723723197,71.97459443972309,108.63494517864522,93.97829205409677,118.15558235770176,75.2383693323369,87.01460160640248,56.94578433098512,73.37388353499928,101.73948860020717,81.30639520593445,112.96876165526209,145.9060775520919,135.98392431367003,87.9593573971532,109.58790410107675,79.9981943711519,86.2549045601089,86.51418723869007,82.61440805576251,92.18788170999419,78.25906218610893,128.0263079956651,142.87379795449243,124.46793020353132,128.84241299943557,59.19717229463639,119.46316173696046,107.40963724395706,65.25671287230696,54.26394486452059,72.01406436011324,81.03040799516505,99.27755245287764,101.2603546341196,100.19149680834929,87.52340058507556,86.76001533732511,140.14077691697145,88.09369157465817,83.54832136104424,94.01077094808221,138.22654088950745,139.79317528273026,131.04960974415624,66.49122160779291,116.41768223331763,104.47519815286348,68.95416990113964,117.55966959787389,114.11525705202538,64.14323367570088,77.75373878068982,77.18211818057571,106.9026915570326,78.27695409294783,80.0106963218241,100.84903699304779,106.92001528562653,138.80740756501964,67.27422610812543,68.97367239096164,97.35531171697731,103.28927386278647,145.51033302286876,131.48795838644202,75.79541541836684,106.1203939051816,94.59970357622436,67.47466676773875,73.83931497349796,112.54015882850024,135.22553825430631,75.17447461278854,58.25146906934029,86.93644793883776,121.75494531791367,93.03617272844843,109.03366289427106,81.74089600629046,94.09596250895052,96.4363353204525,125.63263729821898,105.17124298970427,113.12298715059654,88.8771840043584,131.4809962993105,117.7124912462634,143.89602740798352,85.74451057590188,84.30500491545862,80.23444060873435,122.12836391728592,133.74202635127855,129.09216488029682,146.74014619834634,147.7944187745083,65.95695207449532,94.60960093336742,102.86872810845409,136.11629566180395,69.0752909022287,70.83319883340732,60.19943118496679,112.44486590778165,65.48259344356121,149.2551276350592,104.37223057716454,137.47572069897734,78.49593874857469,145.67534552597294,94.32095813878247,67.72098686684635,95.02543229156483,101.65429573867027,78.82794382800938,89.9678652408514,86.96869198876738,107.35876574849297,91.45952068394459,112.35217052090789,71.80531630150769,66.17382803305418,107.13652231391258,118.25841723147687,82.22808203607623,99.04851612941474,103.63709944986562,90.22714229301974,80.76803887777065,62.97818349159079,90.03849540708147,145.76361209217302,109.42114976317063,85.13712964392471,75.12245045010818,110.74649033537318,61.355351731075515,110.74693182779481,99.46934300469961,97.23041111707069,92.84073008205914,108.36756769580526,112.80118629155966,109.6948125557739,114.73864139299938,112.73604714833692,94.8088605548625,133.74708416085298,116.72394697804276,87.14130823749659,90.51350895279786,87.1283234326716,72.6571608824266,128.37340455569358,120.35983833536883,101.61186909352386,89.01612301122816,63.48985594237053,109.05512404336466,148.69149365131636,123.87394419243859,111.81477368654242,111.24298038662953,69.55615620746167,134.86702793896984,99.84232756123967,54.00532717964281,137.7403850783649,55.49063188724781,120.95934775626343,54.974707568085904,126.93091081641923,72.5605955841313,88.29948854023024,111.87365483945003,74.99539857758026,127.95635120734224,76.05549075917692,82.12832955321439,80.89810303676455,117.99050452528013,81.17180302746934,88.29744602797203,93.7427473960385,92.10711430851298,105.23243628338096,77.93306633521881,56.72572584848383,72.37782247833269,125.62756687421515,66.79115844657318,97.2184026453811,138.49876015171316,116.53875463742007,117.3148027310577,75.92235289907833,129.50734328686272,56.30065826149169,87.95728293282666,103.60555388026371,55.44939678488328,110.04969727628011,63.83178067449724,68.23023240401083,79.83280861855415,105.89168984827508,57.862118691800625,101.19948501880285,85.70917549800265,64.55316071124787,63.85992280781929,82.18514373796444,102.88822289991768,134.6308766891946,113.47185763477809,123.58544490506402,86.0846559611524,70.6818463875747,86.81229112073913,120.46180525410352,101.96949810404723,115.71282576552684,123.11347955162503,110.73700831653042,106.50078082238639,74.68748361513073,65.4704927723928,102.09983475072315,55.612958620091746,85.2353420422729,83.14490745279114,114.2953449193367,93.50193989208245,56.131295432652486,102.74842050130584,120.54447055251704,148.68044838737273,121.63754049674252,133.7153315432601,75.9652940130233,126.83368444007333,91.04048542598186,89.68125324050956,109.31168984905844,129.60773597189825,139.02079870115693,68.97460356564291,62.297827879404124,122.88246642889673,99.89173789387984,127.48340745819114,107.01921820323473,96.13065455781431,122.28358491324649,105.55330520447114,74.32383370663574,99.48448798340632,80.9909380698447,92.92673091140797,86.90853637742102,96.86934739714707,105.00555667215411,106.27788289857314,98.41403173924513,119.61450466534511,104.91098133624142,99.12698570531339,100.36189270172748,110.04392925226132,137.22339086093896,108.01022074951906,80.42037807811684,60.6746380036691,115.02885039852737,107.89518558474293,102.06057208887103,108.25352969471741,112.57952582803155,116.5048371933156,81.28360874155346,113.76399930538781,98.0572727816838,105.63578109312346,124.17992903742736,78.9473049825146,60.05264778187585,117.30817868852041,132.30353909101572,99.81087846567893,103.42317103448175,97.0476238511363,96.15717918894663,117.02451764336432,126.14183758246504,111.91737956055421,102.22430357333022,84.37270003686986,114.8838143853383,101.41132617824175,103.30505608216183,112.62498330191211,103.888555806065,70.21557605376896,143.4901650624012,60.85584118160945,89.80324297575302,93.51515346393744,84.03794650502674,112.97309421928018,98.35581444418845,112.23145556867102,100.51250745571548,126.38212961688036,66.47042615659377,79.29449123867649,101.00937811519499,68.46363290123027,138.42984072428442,116.8188649230325,97.57639388053401,145.34399500567014,82.69587740338997,80.11724735456433,127.43831890231856,58.733755333723934,69.81914303505576,79.90608700072754,77.29851026372617,58.274970362641355,66.70395804745542,73.64631219598765,141.84635205156385,145.9269646995831,100.33082540877518,75.61304925990416,142.26822980408335,118.52309876451083,125.45021093053887,84.9938864830653,114.99151683415427,77.63578282236796,144.8672914307529,119.37685371994968,143.62417477365005,82.96153573030192,68.06905723691419,142.78576014949715,98.64204935445106,119.88451082209706,68.26408623314029,91.46071964560241,84.85344350071624,116.17929037271881,79.48482607019764,92.57525148653576,112.70476741787456,109.01629842513711,100.91362690812238,101.09362127697894,106.06911697633078,98.07520862938254,70.4195609779021,131.48453860848417,127.11460738743854,124.66287950581996,126.07347009283802,62.41106909259999,69.38286138366301,96.93831630784791,59.275256794031876,148.43985294234702,100.63940300146132,79.0844262749652,104.70932410925748,86.89993779533843,76.47102744777648,117.02181338759267,93.22845742221358,54.65026042638973,106.74839403893137,80.10651720529609,122.7134407880379,134.45810420142962,131.76794115251943,85.13961963921493,75.21727544724367,116.20957184129084,56.85745264091524,59.210170922761016,107.37864006558122,93.77205588732951,122.6392050284733,69.07907599507185,114.97401409899742,88.95978844615414,142.07688346190875,89.56956726188781,66.72915222527433,100.94342900773465,92.7375186044364,126.56643861256667,75.94632906605942,60.86393106080595,111.44993124981879,114.80306079821692,66.65068065568288,109.48163583671591,85.8203466631097,145.2718475042504,97.32572460411596,105.68595273999131])
	index_list = [194,183,176,406, 17,174,182,249,243,441,159,221,288,66,235,30,163,213,275,429,490,190,133,393,413,67,3]
	fig = plt.figure()
	ax = fig.add_subplot(111)
	plt.axis('off')
	ax.set_xlim([50*(center[0]-center[2]-0.1), 50*(center[0]+center[2]+0.1)])
	ax.set_ylim([50*(center[1]-center[2]-0.1), 50*(center[1]+center[2]+0.1)])
	ax.set_aspect('equal', adjustable='box')
	''' big circle ''' 
	circle = plt.Circle((100,100), radius=50, edgecolor='k',fill=False)
	ax.add_artist(circle)
	''' plog points, including boundary points and obser. points, with triangulation '''
	triang = mtri.Triangulation(x, y)
	ax.plot(list(itemgetter(*index_list)(x)),list(itemgetter(*index_list)(y)))
	ax.triplot(triang, c="#D3D3D3", marker='.', markerfacecolor="black", markeredgecolor="black", markersize=5)
	''' plot 16 boundary points '''
	if True:
		for i in range(16):
			circle = plt.Circle((x[i], y[i]), radius=0.02, edgecolor='k',facecolor='k')
			ax.add_artist(circle)

	for i, txt in enumerate(range(1,len(x)+1)):
		ax.annotate(txt-1,  (x[i]+0.02, y[i]-0.02), horizontalalignment='right', verticalalignment='top',size=10)
	plt.show()

def plot_ObP_3D_surface():
	center = [2,2,1.0]
	x = np.array([128.44981342158053,84.56240865525592,121.2862152951911,94.66147115455237,142.78878230839828,118.55188253847233,93.51096202535497,102.49205427604416,124.39530612049268,79.86696405219413,89.03689056889387,103.02633937347305,126.44940854392584,103.87114334320655,98.27009682473694,136.86414483273154,107.65184938785559,94.44053562661715,63.17041773503485,103.46728535499948,94.56712622613045,97.78508730576658,60.5546156568375,120.22815901438577,94.75172606735637,81.10162351085458,121.86082959845889,97.67816672823906,114.07166078754933,84.59839619758206,89.66303045294227,119.8924371828999,75.72517043035167,123.26774152998676,129.2487288068016,95.6685243862141,69.93515599213498,125.87639547659961,80.12005851130318,93.87998623377553,97.54577284003585,71.56637979580822,148.14435913258532,92.67953636535366,128.82068583404975,54.061741382309435,74.42163524313644,94.57486355048627,119.60047867430133,63.6978931825982,79.93409362800833,120.02396796539792,84.66424457495533,144.7503012661855,78.18110023826598,101.26975400414662,64.82662483570726,132.41385987641576,141.0528543086548,124.38800584229874,62.54583584210523,79.05606682271684,135.37732600006458,69.6344061954732,130.14162692674276,71.5637240844256,86.05192028611047,87.4641554909154,72.52523755908312,79.41433387254551,67.56420760362667,139.85883732368146,127.27002337811857,58.94620805972926,65.31164243651455,101.33714506941574,104.5635314374962,114.07130282323428,83.77619398146412,110.28049609036789,126.31497668921399,109.22880271660875,84.84673782004687,136.99271744115,66.18315331960306,94.17661854277826,96.40491473388171,92.8654539136139,68.88801217904339,135.14369279375745,83.35667636072075,99.02581653973911,91.49251334102084,63.99233905571974,58.9551229925152,77.45461215401357,104.47771392478545,84.04454076468654,60.334251049510115,59.3170647429539,112.00560468203602,77.47979371790599,111.20827487664853,97.74287905761443,83.54588891535673,70.21892628953272,113.38405223267192,139.5472020849575,96.40405675476426,132.31770602893283,78.37394950222951,116.66845670592699,61.87638013573318,121.37580904597507,120.2467713783312,71.03113162029075,74.19264105118533,71.24388761388842,86.63079057519157,126.36645418633528,112.8282726495075,60.75664935888301,112.43629792969972,119.14904250797913,119.50017864122037,129.95438709324785,123.67019282773026,117.35921425873399,78.15132109347279,116.92133668962543,76.44704749669769,111.7793548600043,134.210550050176,86.1716135915301,62.59435590601592,129.41147907692857,99.49114493940199,94.1769420736607,72.79371362432485,76.5390791151624,143.8832982097086,137.0350410999473,125.74053902443518,106.75808970938564,105.56688768178985,84.17275651970829,59.58820236061386,85.29506483922977,129.85822706019064,114.02745504703628,65.9024102921388,62.54415029056757,85.05946493101467,69.69821000908205,126.44542654658015,102.60063039384994,74.20931760237129,126.33486658653052,85.72910097631717,88.5220029379692,80.83828153076028,139.31848533767445,99.64976417694679,91.11272777814791,125.93346976813142,141.77352761895975,96.75147191597945,72.81236271120824,124.85849636048573,105.73260796250237,100.94361281146094,118.90550834919375,131.74444373816115,55.77734783702928,89.45548142384877,64.30279907540309,93.67060209833834,65.26121013507485,141.80059364765316,80.664924051084,111.74044336233342,70.45345777066927,89.73508682074592,95.06454324735691,97.6943473793895,121.7538706427567,147.8473206972182,122.1147100148242,118.65571461159183,136.77587343922943,88.23563815124473,123.4596402785679,71.33490253745272,108.5059476025612,93.75060789724104,116.84172199568997,116.99684847529808,83.26268092868668,103.37680486303023,90.4046373941086,125.76344913146711,91.55644173856815,130.60532315805565,95.7216781969943,119.69178184355805,79.37125763609461,95.64671771432097,117.80793960715359,77.63425871064378,109.17509188738576,131.17354792227874,111.28239997797577,64.63518414863003,89.28919088567238,55.560184761364994,63.22944102149401,139.56076025860872,119.86590474640053,91.43348948417858,61.053775199061164,91.7573178954228,87.44086240461112,101.05123012632727,77.2668187797511,74.90412493114195,111.43158607416801,87.15220033279118,143.54676685074722,105.15285138729563,60.747549703973036,143.04423667410208,133.00438803445363,64.49999141537558,131.80054952180174,68.25991331084083,89.07012940327574,69.48141040873108,70.28267176417748,112.16322515441226,79.8184121632773,69.50524729816475,124.25431196695752,127.33696972817117,90.78048358330841,103.93247733945697,128.98886762699655,96.80126886232307,52.55640476777419,109.96134759978884,93.10382071750392,57.4083209683419,70.09351421470814,138.64986901834888,88.70784065366159,149.49974888221206,103.11449388316889,78.97850304719637,96.4590043485597,58.49149795967077,85.50817328903568,119.58611862003478,131.4001446700872,64.7406674541364,125.02611277752908,103.13207721902333,139.3256268503343,91.08579912633003,63.32244016511609,80.70647693120989,64.72250367548918,105.7956016739927,121.01077653328815,132.50318122661562,147.34661926115865,122.44825406441129,90.18812257342425,82.84658352807172,113.39795913419269,113.46589455281864,117.52641842132591,53.23264796723277,129.74336845047753,83.7301015662907,108.06272946244364,62.22028440970633,64.58070169877392,78.05512516278425,116.8977946975341,87.25000073660726,105.17361123097118,137.4759067222546,112.90038413468095,62.236202959754735,118.5484336746836,105.63120686280767,117.94544395817783,81.73935281295684,106.00186096582654,117.98844307986043,75.25460001246252,71.09959522146771,126.39243581938567,118.15247585696778,124.66006998911948,75.16475712560495,132.71338717223438,106.35970665661807,139.77052092336564,93.73306089521039,148.009619632092,79.09713879723171,124.66185441155251,138.94710069325774,136.98300080711806,61.65056696291684,134.2004843623394,129.52542453580736,108.79505870010613,86.88255454018102,69.61137786563819,74.53859560752404,128.10867686024886,121.60432270594899,97.44878759253531,62.62424275393528,104.62860073935308,141.15904324995697,108.20770485142165,92.76516011790267,104.13229710579563,59.632319875945846,64.83260081675778,108.41397243606978,133.62174847651983,127.2605441751222,73.58055117738105,123.35527172586444,81.14488848798783,106.29906971832972,124.09491262667377,64.3851073872828,119.46922355537161,127.05446993408174,123.19446704078354,70.5119603148072,58.45319810911137,133.65231142931373,106.03811762061393,81.63927887530855,109.07518673528264,56.88962535071339,108.66476695080732,119.73638023234956,73.96096763062891,108.24877338245442,62.71021794055008,132.8980095700703,70.24971453623394,68.44276354282961,114.25338077594134,141.56971139418835,98.60773427193881,64.01203457128086,133.12202506765652,83.67956671327119,94.26573914279986,128.5516291994325,93.74597335933507,128.74346357453717,105.96257688598511,68.91063990759518,143.78881673978407,64.92734638290145,116.25866023080455,108.53999711716178,124.87000101500297,80.27428424124436,105.69686168387963,140.65614221822682,141.9963507352201,77.93208826793673,127.15452630797999,113.6694669907798,77.79603493945991,117.55968318659737,73.16923415438255,59.55148866345269,74.63923979020721,118.91339748151466,117.27917233626775,56.222361487362996,125.94490489848016,84.26252743147424,85.33798000272073,123.97141310370479,82.03456748631646,142.12737053536114,74.62385320073832,136.3628471638025,68.70540790053931,59.303226957069,100.97120382933991,76.1443889644476,90.81825686839613,53.2608979994206,114.83172445171614,94.30176852820716,121.1855677927401,144.68432200870555,84.40754615444503,139.25528424507317,144.62060787618677,121.24214339031415,86.39854599158447,65.61717910261613,100.49463155749474,57.48080005745811,104.33870968855288,72.55375999714369,93.9019971196587,99.4474423318994,91.53809043517674,90.15555717427803,67.47771327842801,114.8471124879285,145.57998258183275,62.766993626741886,72.81693436867597,53.45470568348214,90.24285953612905,112.02200730609853,63.811050859196364,81.08085955128949,83.09761154954064,62.50363491936134,101.10396033882645,105.38130746605816,109.8714856716659,65.06188646503016,138.51471395491598,69.83968955375286,87.82243607960737,79.36174332386678,81.69875388090169,60.28251159932552,142.09523562956824,94.01938248399425,91.92370799793996,91.6161870770148,112.80615782268815,107.63545200102438,67.56909146183429,122.0522236118053,103.04382563255609,139.8835386759736,118.51167937380906,134.06216116085423,99.51410601031712,112.66956158704605,96.05783727837168,130.44328602174414,68.03472547040094,146.00961602137065,57.1058177577192,66.79040122740547,139.59631130544827,60.17154018647939,99.84631003374773,103.03630991424058,129.76389326510932,113.05908142130588,78.43471412562731,86.67331943317984,126.00329970470658,66.46335491224252,68.13603476147341,78.17242323643944,82.97561032372587,63.33508937986348,99.04988835947927,98.33976035502411,79.68014619438767,103.1414808232785,108.19611059261209,86.4657516598464,75.1502802250062,117.72965561851197,67.01348848836292,122.34963901227695,140.81561391728326,90.12979662814881,128.39173485341553,69.26339195073042,59.89473985866326,99.78692895373786,110.63771976787811,117.85433928336795,115.64831695588691,58.53615127479157,116.70905267926896])
	y = np.array([127.04016672058916,126.82504936570822,140.60935284397885,50.93960242959375,121.306339633182,75.72799649228095,85.48440885931218,63.73552474548612,138.5848615299764,138.27823616004736,87.53524041140015,93.4118462376348,106.55677418221062,114.80217042248695,149.11954738191523,74.27963208366972,104.54523937164744,137.23727777216115,132.01596274029822,89.93022183625646,57.243785451034135,60.762464886834145,102.0764522677371,60.53173321656088,148.76841314547698,55.224880055163275,142.84523461561557,133.01846589801144,94.52292389315737,125.33600403207548,93.42660205196725,58.24651579898532,82.80130384696191,88.17535606905096,71.05463140351857,131.60456168035205,113.48360689069297,76.8806973042305,125.39390530040606,116.44834129939012,83.58242499492405,67.34392488243917,96.80888989336798,96.30529944734077,113.67399239633413,84.60263349873821,81.52976025156033,125.42769935531246,66.7467109034571,69.52185962664473,90.73882288958556,55.113886257320985,54.99092196519448,121.50658123890541,87.29180920872669,93.62522747316004,118.51745607668383,81.04362408285579,79.13697881148649,63.85881613676716,88.602277103146,84.42560874173574,72.75908766055814,116.37622401222221,98.12321386166245,116.64574155912926,100.2314568965994,56.46906154877828,119.51480025045565,119.20033463481752,100.96014145800017,128.7575309650237,64.83473553409749,119.96268186704783,81.21116423117756,108.14091782683852,88.25546166003177,120.05613215096167,76.50764766412442,58.813668527824305,108.8082065056471,142.10034679688417,106.77780534580347,121.72438391115467,66.7858331341199,73.63547405312043,88.39405919671572,111.22444885690308,98.46158723723197,71.97459443972309,108.63494517864522,93.97829205409677,118.15558235770176,75.2383693323369,87.01460160640248,56.94578433098512,73.37388353499928,101.73948860020717,81.30639520593445,112.96876165526209,145.9060775520919,135.98392431367003,87.9593573971532,109.58790410107675,79.9981943711519,86.2549045601089,86.51418723869007,82.61440805576251,92.18788170999419,78.25906218610893,128.0263079956651,142.87379795449243,124.46793020353132,128.84241299943557,59.19717229463639,119.46316173696046,107.40963724395706,65.25671287230696,54.26394486452059,72.01406436011324,81.03040799516505,99.27755245287764,101.2603546341196,100.19149680834929,87.52340058507556,86.76001533732511,140.14077691697145,88.09369157465817,83.54832136104424,94.01077094808221,138.22654088950745,139.79317528273026,131.04960974415624,66.49122160779291,116.41768223331763,104.47519815286348,68.95416990113964,117.55966959787389,114.11525705202538,64.14323367570088,77.75373878068982,77.18211818057571,106.9026915570326,78.27695409294783,80.0106963218241,100.84903699304779,106.92001528562653,138.80740756501964,67.27422610812543,68.97367239096164,97.35531171697731,103.28927386278647,145.51033302286876,131.48795838644202,75.79541541836684,106.1203939051816,94.59970357622436,67.47466676773875,73.83931497349796,112.54015882850024,135.22553825430631,75.17447461278854,58.25146906934029,86.93644793883776,121.75494531791367,93.03617272844843,109.03366289427106,81.74089600629046,94.09596250895052,96.4363353204525,125.63263729821898,105.17124298970427,113.12298715059654,88.8771840043584,131.4809962993105,117.7124912462634,143.89602740798352,85.74451057590188,84.30500491545862,80.23444060873435,122.12836391728592,133.74202635127855,129.09216488029682,146.74014619834634,147.7944187745083,65.95695207449532,94.60960093336742,102.86872810845409,136.11629566180395,69.0752909022287,70.83319883340732,60.19943118496679,112.44486590778165,65.48259344356121,149.2551276350592,104.37223057716454,137.47572069897734,78.49593874857469,145.67534552597294,94.32095813878247,67.72098686684635,95.02543229156483,101.65429573867027,78.82794382800938,89.9678652408514,86.96869198876738,107.35876574849297,91.45952068394459,112.35217052090789,71.80531630150769,66.17382803305418,107.13652231391258,118.25841723147687,82.22808203607623,99.04851612941474,103.63709944986562,90.22714229301974,80.76803887777065,62.97818349159079,90.03849540708147,145.76361209217302,109.42114976317063,85.13712964392471,75.12245045010818,110.74649033537318,61.355351731075515,110.74693182779481,99.46934300469961,97.23041111707069,92.84073008205914,108.36756769580526,112.80118629155966,109.6948125557739,114.73864139299938,112.73604714833692,94.8088605548625,133.74708416085298,116.72394697804276,87.14130823749659,90.51350895279786,87.1283234326716,72.6571608824266,128.37340455569358,120.35983833536883,101.61186909352386,89.01612301122816,63.48985594237053,109.05512404336466,148.69149365131636,123.87394419243859,111.81477368654242,111.24298038662953,69.55615620746167,134.86702793896984,99.84232756123967,54.00532717964281,137.7403850783649,55.49063188724781,120.95934775626343,54.974707568085904,126.93091081641923,72.5605955841313,88.29948854023024,111.87365483945003,74.99539857758026,127.95635120734224,76.05549075917692,82.12832955321439,80.89810303676455,117.99050452528013,81.17180302746934,88.29744602797203,93.7427473960385,92.10711430851298,105.23243628338096,77.93306633521881,56.72572584848383,72.37782247833269,125.62756687421515,66.79115844657318,97.2184026453811,138.49876015171316,116.53875463742007,117.3148027310577,75.92235289907833,129.50734328686272,56.30065826149169,87.95728293282666,103.60555388026371,55.44939678488328,110.04969727628011,63.83178067449724,68.23023240401083,79.83280861855415,105.89168984827508,57.862118691800625,101.19948501880285,85.70917549800265,64.55316071124787,63.85992280781929,82.18514373796444,102.88822289991768,134.6308766891946,113.47185763477809,123.58544490506402,86.0846559611524,70.6818463875747,86.81229112073913,120.46180525410352,101.96949810404723,115.71282576552684,123.11347955162503,110.73700831653042,106.50078082238639,74.68748361513073,65.4704927723928,102.09983475072315,55.612958620091746,85.2353420422729,83.14490745279114,114.2953449193367,93.50193989208245,56.131295432652486,102.74842050130584,120.54447055251704,148.68044838737273,121.63754049674252,133.7153315432601,75.9652940130233,126.83368444007333,91.04048542598186,89.68125324050956,109.31168984905844,129.60773597189825,139.02079870115693,68.97460356564291,62.297827879404124,122.88246642889673,99.89173789387984,127.48340745819114,107.01921820323473,96.13065455781431,122.28358491324649,105.55330520447114,74.32383370663574,99.48448798340632,80.9909380698447,92.92673091140797,86.90853637742102,96.86934739714707,105.00555667215411,106.27788289857314,98.41403173924513,119.61450466534511,104.91098133624142,99.12698570531339,100.36189270172748,110.04392925226132,137.22339086093896,108.01022074951906,80.42037807811684,60.6746380036691,115.02885039852737,107.89518558474293,102.06057208887103,108.25352969471741,112.57952582803155,116.5048371933156,81.28360874155346,113.76399930538781,98.0572727816838,105.63578109312346,124.17992903742736,78.9473049825146,60.05264778187585,117.30817868852041,132.30353909101572,99.81087846567893,103.42317103448175,97.0476238511363,96.15717918894663,117.02451764336432,126.14183758246504,111.91737956055421,102.22430357333022,84.37270003686986,114.8838143853383,101.41132617824175,103.30505608216183,112.62498330191211,103.888555806065,70.21557605376896,143.4901650624012,60.85584118160945,89.80324297575302,93.51515346393744,84.03794650502674,112.97309421928018,98.35581444418845,112.23145556867102,100.51250745571548,126.38212961688036,66.47042615659377,79.29449123867649,101.00937811519499,68.46363290123027,138.42984072428442,116.8188649230325,97.57639388053401,145.34399500567014,82.69587740338997,80.11724735456433,127.43831890231856,58.733755333723934,69.81914303505576,79.90608700072754,77.29851026372617,58.274970362641355,66.70395804745542,73.64631219598765,141.84635205156385,145.9269646995831,100.33082540877518,75.61304925990416,142.26822980408335,118.52309876451083,125.45021093053887,84.9938864830653,114.99151683415427,77.63578282236796,144.8672914307529,119.37685371994968,143.62417477365005,82.96153573030192,68.06905723691419,142.78576014949715,98.64204935445106,119.88451082209706,68.26408623314029,91.46071964560241,84.85344350071624,116.17929037271881,79.48482607019764,92.57525148653576,112.70476741787456,109.01629842513711,100.91362690812238,101.09362127697894,106.06911697633078,98.07520862938254,70.4195609779021,131.48453860848417,127.11460738743854,124.66287950581996,126.07347009283802,62.41106909259999,69.38286138366301,96.93831630784791,59.275256794031876,148.43985294234702,100.63940300146132,79.0844262749652,104.70932410925748,86.89993779533843,76.47102744777648,117.02181338759267,93.22845742221358,54.65026042638973,106.74839403893137,80.10651720529609,122.7134407880379,134.45810420142962,131.76794115251943,85.13961963921493,75.21727544724367,116.20957184129084,56.85745264091524,59.210170922761016,107.37864006558122,93.77205588732951,122.6392050284733,69.07907599507185,114.97401409899742,88.95978844615414,142.07688346190875,89.56956726188781,66.72915222527433,100.94342900773465,92.7375186044364,126.56643861256667,75.94632906605942,60.86393106080595,111.44993124981879,114.80306079821692,66.65068065568288,109.48163583671591,85.8203466631097,145.2718475042504,97.32572460411596,105.68595273999131])
	# x = x[0:300]
	# y = y[0:300]
	z = np.sinc((1-x)/100*3.14) + np.sinc((1-y)/100*3.14)+0.3
	index_list = [194,183,176,406, 17,174,182,249,243,441,159,221,288,66,235,30,163,213,275,429,490,190,133,393,413,67,3]

	fig = plt.figure()
	ax = fig.add_subplot(111,projection='3d')
	
	plt.axis('off')
	ax.set_xlim([50*(center[0]-center[2]-0.1), 50*(center[0]+center[2]+0.1)])
	ax.set_ylim([50*(center[1]-center[2]-0.1), 50*(center[1]+center[2]+0.1)])
	ax.set_zlim(min(z), max(z))

	# ax.set_aspect('equal', adjustable='box')
	# big circle 
	p = Circle((100, 100), 50,fill=None, alpha = 0.9)
	ax.add_patch(p)
	art3d.pathpatch_2d_to_3d(p, z=0)

	triang = mtri.Triangulation(x, y)
	ax.triplot(triang, c="#D3D3D3", marker='.', markerfacecolor="black", markeredgecolor="black", markersize=2)
	# ax.triplot(triang, c="#D3D3D3", marker='.', markerfacecolor="black", markeredgecolor="black", markersize=5)

	ax.plot_trisurf(triang, z, cmap='jet',alpha=1,linewidth=0.3)
	ax.scatter(x,y,z, marker='.', s=5, c="black", alpha=0.5)
	# ax.view_init(elev=60, azim=-45)
	# ax.plot(list(itemgetter(*index_list)(x)),list(itemgetter(*index_list)(y)),list(itemgetter(*index_list)(z)),c=
	# 	'black',linewidth=2,linestyle='solid')
	plt.show()

def write_triGraph(instance, filename, nb_ObPs):
	departure, arrival, tar_locs, tar_rews, OBPX, OBPY, OBPREW = read_instance(instance)
	file = open(filename, "w")
	''' write observation points '''
	for i in range(len(tar_locs)):
		triang = mtri.Triangulation(OBPX[i][0:nb_ObPs], OBPY[i][0:nb_ObPs])
		file.write(str(len(triang.edges)) + '\t')
		for e in triang.edges:
			file.write(str(e[0]) + ':' + str(e[1]) + '\t')
		file.write('\n')
	
	file.close()



if __name__ == "__main__":
	instance = argv[1]
	nb_ObPs = int(argv[2])
	nb_ObPs += 16
	'''two depots, n target areas, reward pct, all observation points, and reward values on Obser. point '''
	departure, arrival, tar_locs, tar_rews, OBPX, OBPY, OBPREW = read_instance(instance)
	tar_idx = 4
	# plot_ObP_graph(tar_locs[tar_idx], OBPX[tar_idx][0:nb_ObPs], OBPY[tar_idx][0:nb_ObPs], OBPREW[tar_idx][0:nb_ObPs])
	# plot_ObP_graph222()
	# plot_ObP_3D_surface()



	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_200'
	write_triGraph(instance, filename, 200)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_180'
	write_triGraph(instance, filename, 180)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_150'
	write_triGraph(instance, filename, 150)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_120'
	write_triGraph(instance, filename, 120)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_100'
	write_triGraph(instance, filename, 100)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_80'
	write_triGraph(instance, filename, 80)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_60'
	write_triGraph(instance, filename, 60)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_50'
	write_triGraph(instance, filename, 50)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_40'
	write_triGraph(instance, filename, 40)
	filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_30'
	write_triGraph(instance, filename, 30)
	# filename = '/home/cai/Dropbox/Box_Research/Github/RRARP_LinKern/dat/InnerGraphs/n_6_h_1.graph_15'
	# write_triGraph(instance, filename, 16+15)


